<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Web Exploitation – Easy</title>
  <link rel="stylesheet" href="../css/writeup.css">

</head>

<body>
  <div class="writeup-layout">

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">
      <h2>Web Exploitation</h2>
      <h3><a href="../WebExDesc.html">Web Exploitation Overview</a>
</h3>
      <details closed>
  <summary>Easy Challenges</summary>
  <ul>
    <li><a href="../Easy/Crack_the_Gate_1.html">Crack the Gate 1</a></li>
    <li><a href="coming_soon.html">SSTI1</a></li>
    <li><a href="coming_soon.html">n0s4n1ty 1</a></li>
    <li><a href="../Easy/Cookie_Monster.html">Cookie Monster Secret Recipe</a></li>
    <li><a href="../Easy/Web_Decoder.html">WebDecode</a></li>
    <li><a href="../Easy/Unminify.html">Unminify</a></li>
    <li><a href="../Easy/introtoburpsuite.html">IntroToBurp</a></li>
    <li><a href="../Easy/Bookmarklet.html">Bookmarklet</a></li>
    <li><a href="../Easy/Local_Authority.html">Local Authority</a></li>
    <li><a href="../Easy/Inspect_HTML.html">Inspect HTML</a></li>
    <li><a href="../Easy/Includes.html">Includes</a></li>
    <li><a href="../Easy/Cookie.html">Cookies</a></li>
    <li><a href="../Easy/Scavenger_Hunt.html">Scavenger Hunt</a></li>
    <li><a href="../Easy/Get_aHead.html">GET aHEAD</a></li>
    <li><a href="../Easy/dont_use_client_side.html">dont-use-client-side</a></li>
    <li><a href="../Easy/logon.html">logon</a></li>
    <li><a href="../Easy/Insp3ct0r.html">Insp3ct0r</a></li>
    <li><a href="../Easy/where_are_the_robots.html">where are the robots</a></li>
  </ul>
</details>

    <details open>
  <summary>Medium Challenges</summary>
  <ul>
    <li><a href="Crack_the_Gate_2.html">Crack the Gate 2</a></li>
    <li><a href="">byp4ss3d</a></li>
    <li><a href="">Pachinko</a></li>
    <li><a href="">SSTI 2</a></li>
    <li><a href="../Medium/3v@l.html">3v@l</a></li>
    <li><a href="">WebSockFish</a></li>
    <li><a href="">ApritiSesamo</a></li>
    <li><a href="">Trickster</a></li>
    <li><a href="No_SQL_Injection.html">No Sql Injection</a></li>
    <li><a href="">SOAP</a></li>
    <li><a href="More_SQLi.html">More SQLi</a></li>
    <li><a href="MatchTheRegex.html">MatchTheRegex</a></li>
    <li><a href="">Java Code Analysis!?!</a></li>
    <li><a href="">findme</a></li>
    <li><a href="">SQLiLite</a></li>
    <li><a href="">SQL Direct</a></li>
    <li><a href="../Medium/Secrets.html">Secrets</a></li>
    <li><a href="">Search Source</a></li>
    <li><a href="../Medium/Roboto_Sans.html">Roboto Sans</a></li>
    <li><a href="Power_Cookie.html">Power Cookie</a></li>
    <li><a href="Forbidden_Paths.html">Forbidden Paths</a></li>
    <li><a href="">JAuth</a></li>
    <li><a href="">caas</a></li>
    <li><a href="">login</a></li>
    <li><a href="SuperSerial.html">Super Serial</a></li>
    <li><a href="">Most Cookies</a></li>
    <li><a href="">Web Gauntlet 2</a></li>
    <li><a href="">Some Assembly Required 1</a></li>
    <li><a href="">Who are you?</a></li>
    <li><a href="">Some Assembly Required 2</a></li>
    <li><a href="">Web Gauntlet 3</a></li>
    <li><a href="">More Cookies</a></li>
    <li><a href="">It is my Birthday</a></li>
    <li><a href="">Startup Company</a></li>
    <li><a href="">Web Gauntlet</a></li>
    <li><a href="Irish-Name-Repo_1.html">Irish-Name-Repo 1</a></li>
    <li><a href="Irish-Name-Repo_2.html">Irish-Name-Repo 2</a></li>
    <li><a href="">Irish-Name-Repo 3</a></li>
    <li><a href="">Client-side-again</a></li>
    <li><a href="">picobrowser</a></li>
  </ul>
</details>

    <details closed>
  <summary>Hard Challenges</summary>
  <ul>
    <li><a href="">secure-email-service</a></li>
    <li><a href="">Pachinko Revisited</a></li>
    <li><a href="">elements</a></li>
    <li><a href="">msfroggenerator2</a></li>
    <li><a href="">cancri-sp</a></li>
    <li><a href="">noted</a></li>
    <li><a href="">Live Art</a></li>
    <li><a href="">notepad</a></li>
    <li><a href="">Bithug</a></li>
    <li><a href="">X marks the spot</a></li>
    <li><a href="">Some Assembly Required 3</a></li>
    <li><a href="">Some Assembly Required 4</a></li>
    <li><a href="">Java Script Kiddie</a></li>
    <li><a href="">Java Script Kiddie 2</a></li>
  </ul>
</details>

      <a class="back-home" href="../../index.html">← Back to Index</a>
    </aside>

    <!-- ===== CONTENT ===== -->
    <main class="content">
      <section id="challenge1">
        <h1>No SQL Injection (Medium)</h1>
        <ul>
          <li>Challenge Link: https://play.picoctf.org/practice/challenge/443?category=1&difficulty=2&page=1</li>
          <li>Challenge Description: Can you try to get access to this website to get the flag? You can download the source here.</li>
        </ul>
      </section>

      <section>
        <h1>Solution</h1>
        <p>Looking at the website, using inspect and searching around, we won't find anything of use. So let us look into the source file that was provided.</p>
        <pre>ls
app.tar.gz</pre>
        <p>It is a tape archive (tar) that has been compressed, meaning we need to decompress it to see the contents inside, by running:</p>
        <pre>tar -xvf app.tar.gz</pre>
        <p>These files will show up:</p>
        <img src="../Images/NoSQL/Tar.png" alt="Extracted contents 1">
        <img src="../Images/NoSQL/Tar2.png" alt="Extracted contents 2">
        <p>Reading all those files, only server.js stands out, if we look closely, we can see that the server is using MongoDB. MongoDB is a popular, open source, NoSQL database that stores data in flexible, JSON-like documents rather than traditional rows and columns, making it ideal for dynamic data and modern applications needing scalability, high availability, and easy integration with application code. Now we can confirm that we have to do an nosql injection. We can use a basic authentication bypass, by typing '{"$ne": null}' in the username and password field, we trick the server into thinking that we are a valid user.</p>
        <pre>{"$ne": null}</pre>
        <img src="../Images/NoSQL/Admin.png" alt="'Admin' Login">
        <p>Unfortunately, the flag is not present, using inspect element doesn't give us anything either. Let's try logging in again with our bypass credentials, but this time we use BurpSuite to intercept our request. Turning the intercept on, then logging in again will give us our request, send it to the repeater. In the repeater, we see our request with our credentials, we click send to see the response. As you can see, the token is encoded in Base64, so we must use a decoder to see what it contains.</p>
        <img src="../Images/NoSQL/Repeater.png" alt="Repeater">
        <pre>cGljb0NURntqQmhEMnk3WG9OelB2XzFZeFM5RXc1cUwwdUk2cGFzcWxfaW5qZWN0aW9uXzY3YjFhM2M4fQ==
becomes
picoCTF{jBhD2y7XoNzPv_1YxS9Ew5qL0uI6pasql_injection_67b1a3c8}</pre>
        <p>There is our flag.</p>
      </section>

      <section>
        <h1>Sources</h1>
        <ul>
          <li><a href="https://www.base64decode.org/">Decoder</a></li>
          <li><a href="https://en.wikipedia.org/wiki/List_of_archive_formats">Archive/Compression Formats</a></li>
          <li><a href="https://book.hacktricks.wiki/en/pentesting-web/nosql-injection.html">Hacking Tricks - NoSQL</a></li>
          <li><a href="https://mariadb.com/docs/server/server-usage/storage-engines/connect/connect-table-types/connect-json-table-type">JSON Tables</a></li>
          <li><a href="https://www.postgresql.org/docs/current/functions-json.html">JSON Table Functions</a></li>
          <li><a href="https://dev.mysql.com/doc/refman/8.4/en/json-table-functions.html">More JSON Table Functions</a></li>
          <li><a href="https://developer.ibm.com/articles/i-json-table-trs/">IBM JSON Tables</a></li>
          <li><a href="https://cs186berkeley.net/resources/static/notes/n17-NoSQL.pdf">NoSQL - Gabe Fierro, Saurav Chhatrapati</a></li>
        </ul>
      </section>

    </main>
  </div>
</body>
</html>
