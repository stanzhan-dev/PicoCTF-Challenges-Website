<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Web Exploitation – Easy</title>
  <link rel="stylesheet" href="../css/writeup.css">

</head>

<body>
  <div class="writeup-layout">

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">
      <h2>Web Exploitation</h2>
      <h3><a href="../WebExDesc.html">Web Exploitation Overview</a>
</h3>
      <details closed>
  <summary>Easy Challenges</summary>
  <ul>
    <li><a href="../Easy/Crack_the_Gate_1.html">Crack the Gate 1</a></li>
    <li><a href="coming_soon.html">SSTI1</a></li>
    <li><a href="coming_soon.html">n0s4n1ty 1</a></li>
    <li><a href="../Easy/Cookie_Monster.html">Cookie Monster Secret Recipe</a></li>
    <li><a href="../Easy/Web_Decoder.html">WebDecode</a></li>
    <li><a href="../Easy/Unminify.html">Unminify</a></li>
    <li><a href="../Easy/introtoburpsuite.html">IntroToBurp</a></li>
    <li><a href="../Easy/Bookmarklet.html">Bookmarklet</a></li>
    <li><a href="../Easy/Local_Authority.html">Local Authority</a></li>
    <li><a href="../Easy/Inspect_HTML.html">Inspect HTML</a></li>
    <li><a href="../Easy/Includes.html">Includes</a></li>
    <li><a href="../Easy/Cookie.html">Cookies</a></li>
    <li><a href="../Easy/Scavenger_Hunt.html">Scavenger Hunt</a></li>
    <li><a href="../Easy/Get_aHead.html">GET aHEAD</a></li>
    <li><a href="../Easy/dont_use_client_side.html">dont-use-client-side</a></li>
    <li><a href="../Easy/logon.html">logon</a></li>
    <li><a href="../Easy/Insp3ct0r.html">Insp3ct0r</a></li>
    <li><a href="../Easy/where_are_the_robots.html">where are the robots</a></li>
  </ul>
</details>

    <details open>
  <summary>Medium Challenges</summary>
  <ul>
    <li><a href="Crack_the_Gate_2.html">Crack the Gate 2</a></li>
    <li><a href="">byp4ss3d</a></li>
    <li><a href="">Pachinko</a></li>
    <li><a href="">SSTI 2</a></li>
    <li><a href="../Medium/3v@l.html">3v@l</a></li>
    <li><a href="">WebSockFish</a></li>
    <li><a href="">ApritiSesamo</a></li>
    <li><a href="">Trickster</a></li>
    <li><a href="No_SQL_Injection.html">No Sql Injection</a></li>
    <li><a href="">SOAP</a></li>
    <li><a href="More_SQLi.html">More SQLi</a></li>
    <li><a href="MatchTheRegex.html">MatchTheRegex</a></li>
    <li><a href="">Java Code Analysis!?!</a></li>
    <li><a href="">findme</a></li>
    <li><a href="">SQLiLite</a></li>
    <li><a href="">SQL Direct</a></li>
    <li><a href="../Medium/Secrets.html">Secrets</a></li>
    <li><a href="">Search Source</a></li>
    <li><a href="../Medium/Roboto_Sans.html">Roboto Sans</a></li>
    <li><a href="../Medium/Power_Cookie.html">Power Cookie</a></li>
    <li><a href="Forbidden_Paths.html">Forbidden Paths</a></li>
    <li><a href="">JAuth</a></li>
    <li><a href="">caas</a></li>
    <li><a href="">login</a></li>
    <li><a href="SuperSerial.html">Super Serial</a></li>
    <li><a href="">Most Cookies</a></li>
    <li><a href="">Web Gauntlet 2</a></li>
    <li><a href="">Some Assembly Required 1</a></li>
    <li><a href="">Who are you?</a></li>
    <li><a href="">Some Assembly Required 2</a></li>
    <li><a href="">Web Gauntlet 3</a></li>
    <li><a href="">More Cookies</a></li>
    <li><a href="">It is my Birthday</a></li>
    <li><a href="">Startup Company</a></li>
    <li><a href="">Web Gauntlet</a></li>
    <li><a href="Irish-Name-Repo_1.html">Irish-Name-Repo 1</a></li>
    <li><a href="Irish-Name-Repo_2.html">Irish-Name-Repo 2</a></li>
    <li><a href="">Irish-Name-Repo 3</a></li>
    <li><a href="">Client-side-again</a></li>
    <li><a href="">picobrowser</a></li>
  </ul>
</details>

    <details closed>
  <summary>Hard Challenges</summary>
  <ul>
    <li><a href="">secure-email-service</a></li>
    <li><a href="">Pachinko Revisited</a></li>
    <li><a href="">elements</a></li>
    <li><a href="">msfroggenerator2</a></li>
    <li><a href="">cancri-sp</a></li>
    <li><a href="">noted</a></li>
    <li><a href="">Live Art</a></li>
    <li><a href="">notepad</a></li>
    <li><a href="">Bithug</a></li>
    <li><a href="">X marks the spot</a></li>
    <li><a href="">Some Assembly Required 3</a></li>
    <li><a href="">Some Assembly Required 4</a></li>
    <li><a href="">Java Script Kiddie</a></li>
    <li><a href="">Java Script Kiddie 2</a></li>
  </ul>
</details>

      <a class="back-home" href="../../index.html">← Back to Index</a>
    </aside>

    <!-- ===== CONTENT ===== -->
    <main class="content">
      <section id="challenge1">
        <h1>More SQLi (Medium)</h1>
        <ul>
          <li>Challenge Link: https://play.picoctf.org/practice/challenge/358?category=1&difficulty=2&page=1</li>
          <li>Challenge Description: Can you find the flag on this website.</li>
          <li>Hints:</li>
          <ol>
            <li>SQLiLite</li>
          </ol>
        </ul>
      </section>

      <section>
        <h1>Solution</h1>
        <p>This is the login page, we can try typing random credentials and see what happpens:</p>
        <img src="../Images/More SQLi/Login.png" alt="Login Page">
        <img src="../Images/More SQLi/RandomCred.png" alt="Random Credentials">
        <p>Now we know that it's an SQL database we can try a basic SQL injection:</p>
        <pre>' or 1=1;--</pre>
        <p>The single quote is used to close any string that was opened earlier in the SQL query. SQL injection works by closing off part of the query, it allows you to manipulate the rest.</p>
        <pre>'</pre>
        <p>This is a logical condition that is always true. Normally, the SQL query might have a WHERE clause like WHERE city = 'Nairobi'. By adding or 1=1, it turns the condition into something that’s always true, like WHERE city = 'Nairobi' OR 1=1. The database will return all rows, not just the ones where the city is Nairobi.</p>
        <pre>or 1=1</pre>
        <p>This is a comment in SQL. Anything following the -- will be ignored. This is used to comment out any remaining part of the SQL query, which could otherwise interfere with the injected code.</p>
        <pre>--</pre>
        <p>In our example, since 1=1 is always true, this query would retrieve every record in the offices table, not just those related to a specific city.</p>
        <pre>SELECT * FROM offices WHERE city = 'Nairobi' OR 1=1;</pre>
        <img src="../Images/More SQLi/ClassicSQLi.png" alt="SQLi">
        <p>After that, we see more tables with City, Address, and Phone. We can use this table to help us with another injection:</p>
        <pre>' Algiers' union select sql,1,1 from sqlite_master;--</pre>
        <p>The single quote closes the string in the SQL query, just like before.</p>
        <pre>'</pre>
        <p>Combines results from two queries. The UNION operator allows you to merge the result of a second query with the result of the original query. In this case, we are trying to get the database to give us information from two different queries: the one used by the web application and the one we are injecting.</p>
        <pre>union select</pre>
        <p>This part represents the columns we are asking for from the sqlite_master table. Since the original query might return three columns (city, address, phone), we provides values that match the number of columns. For the injected query, 1 is just a placeholder value.</p>
        <pre>sql, 1, 1</pre>
        <p>This is a special system table in SQLite that stores metadata about the database such as information about the tables, columns, and indexes. By querying it, we can see what tables exist, their structure, and other details.</p>
        <pre>sqlite_master</pre>
        <p>The query executed would look something like:</p>
        <pre>SELECT * FROM offices WHERE city = 'Algiers' UNION SELECT sql, 1, 1 FROM sqlite_master;</pre>
        <p>The sqlite_master table contains information about the schema, so the result of this query might look like:</p>
        <pre>CREATE TABLE offices (id INTEGER NOT NULL PRIMARY KEY, city TEXT, address TEXT, phone TEXT);
CREATE TABLE users (name TEXT NOT NULL PRIMARY KEY, password TEXT, id INTEGER);</pre>
        <img src="../Images/More SQLi/AdvancedSQLi.png" alt="Advanced SQLi">
        <p>After that, we do see a table called more_table that contains the flag. Therefore we must do another injection:</p>
        <pre>' Algiers' union select flag,id,1 from more_table;--</pre>
        <p>In this query, we are trying to get the flag and id from the more_table table. The 1 is a placeholder because the original query is returning three columns (city, address, and phone).</p>
        <pre>flag, id, 1:</pre>
        <p>Resulting SQL query:</p>
        <pre>SELECT * FROM offices WHERE city = 'Algiers' UNION SELECT flag, id, 1 FROM more_table;</pre>
        <p>If the more_table contains a column called flag, this query would return those flags. You might see results like:</p>
        <img src="../Images/More SQLi/MoreTable.png" alt="Flag">
      </section>

      <section>
        <h1>Sources</h1>
        <ul>
          <li><a href="https://www.techonthenet.com/sqlite/sys_tables/index.php">SQLite System Tables</a></li>
          <li><a href="https://www.invicti.com/blog/web-security/sql-injection-cheat-sheet">SQL Injection - Invicti</a></li>
          <li><a href="https://www.w3schools.com/sql/sql_injection.asp">w3schools - SQL Injection</a></li>
        </ul>
      </section>

    </main>
  </div>
</body>
</html>
