<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Web Exploitation – Easy</title>
  <link rel="stylesheet" href="../css/writeup.css">

</head>

<body>
  <div class="writeup-layout">

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">
      <h2>Web Exploitation</h2>
      <h3><a href="../WebExDesc.html">Web Exploitation Overview</a>
</h3>
      <details closed>
  <summary>Easy Challenges</summary>
  <ul>
    <li><a href="../Easy/Crack_the_Gate_1.html">Crack the Gate 1</a></li>
    <li><a href="coming_soon.html">SSTI1</a></li>
    <li><a href="coming_soon.html">n0s4n1ty 1</a></li>
    <li><a href="../Easy/Cookie_Monster.html">Cookie Monster Secret Recipe</a></li>
    <li><a href="../Easy/Web_Decoder.html">WebDecode</a></li>
    <li><a href="../Easy/Unminify.html">Unminify</a></li>
    <li><a href="../Easy/introtoburpsuite.html">IntroToBurp</a></li>
    <li><a href="../Easy/Bookmarklet.html">Bookmarklet</a></li>
    <li><a href="../Easy/Local_Authority.html">Local Authority</a></li>
    <li><a href="../Easy/Inspect_HTML.html">Inspect HTML</a></li>
    <li><a href="../Easy/Includes.html">Includes</a></li>
    <li><a href="../Easy/Cookie.html">Cookies</a></li>
    <li><a href="../Easy/Scavenger_Hunt.html">Scavenger Hunt</a></li>
    <li><a href="../Easy/Get_aHead.html">GET aHEAD</a></li>
    <li><a href="../Easy/dont_use_client_side.html">dont-use-client-side</a></li>
    <li><a href="../Easy/logon.html">logon</a></li>
    <li><a href="../Easy/Insp3ct0r.html">Insp3ct0r</a></li>
    <li><a href="../Easy/where_are_the_robots.html">where are the robots</a></li>
  </ul>
</details>

    <details open>
  <summary>Medium Challenges</summary>
  <ul>
    <li><a href="Crack_the_Gate_2.html">Crack the Gate 2</a></li>
    <li><a href="">byp4ss3d</a></li>
    <li><a href="">Pachinko</a></li>
    <li><a href="">SSTI 2</a></li>
    <li><a href="../Medium/3v@l.html">3v@l</a></li>
    <li><a href="">WebSockFish</a></li>
    <li><a href="">ApritiSesamo</a></li>
    <li><a href="">Trickster</a></li>
    <li><a href="No_SQL_Injection.html">No Sql Injection</a></li>
    <li><a href="">SOAP</a></li>
    <li><a href="More_SQLi.html">More SQLi</a></li>
    <li><a href="MatchTheRegex.html">MatchTheRegex</a></li>
    <li><a href="">Java Code Analysis!?!</a></li>
    <li><a href="">findme</a></li>
    <li><a href="">SQLiLite</a></li>
    <li><a href="">SQL Direct</a></li>
    <li><a href="">Secrets</a></li>
    <li><a href="">Search Source</a></li>
    <li><a href="Roboto_Sans.html">Roboto Sans</a></li>
    <li><a href="Power_Cookie.html">Power Cookie</a></li>
    <li><a href="Forbidden_Paths.html">Forbidden Paths</a></li>
    <li><a href="">JAuth</a></li>
    <li><a href="">caas</a></li>
    <li><a href="">login</a></li>
    <li><a href="SuperSerial.html">Super Serial</a></li>
    <li><a href="">Most Cookies</a></li>
    <li><a href="">Web Gauntlet 2</a></li>
    <li><a href="">Some Assembly Required 1</a></li>
    <li><a href="">Who are you?</a></li>
    <li><a href="">Some Assembly Required 2</a></li>
    <li><a href="">Web Gauntlet 3</a></li>
    <li><a href="">More Cookies</a></li>
    <li><a href="">It is my Birthday</a></li>
    <li><a href="">Startup Company</a></li>
    <li><a href="">Web Gauntlet</a></li>
    <li><a href="Irish-Name-Repo_1.html">Irish-Name-Repo 1</a></li>
    <li><a href="Irish-Name-Repo_2.html">Irish-Name-Repo 2</a></li>
    <li><a href="">Irish-Name-Repo 3</a></li>
    <li><a href="">Client-side-again</a></li>
    <li><a href="">picobrowser</a></li>
  </ul>
</details>

    <details closed>
  <summary>Hard Challenges</summary>
  <ul>
    <li><a href="">secure-email-service</a></li>
    <li><a href="">Pachinko Revisited</a></li>
    <li><a href="">elements</a></li>
    <li><a href="">msfroggenerator2</a></li>
    <li><a href="">cancri-sp</a></li>
    <li><a href="">noted</a></li>
    <li><a href="">Live Art</a></li>
    <li><a href="">notepad</a></li>
    <li><a href="">Bithug</a></li>
    <li><a href="">X marks the spot</a></li>
    <li><a href="">Some Assembly Required 3</a></li>
    <li><a href="">Some Assembly Required 4</a></li>
    <li><a href="">Java Script Kiddie</a></li>
    <li><a href="">Java Script Kiddie 2</a></li>
  </ul>
</details>

      <a class="back-home" href="../../index.html">← Back to Index</a>
    </aside>

    <!-- ===== CONTENT ===== -->
    <main class="content">
      <section id="challenge1">
        <h1>MatchTheRegex (Medium)</h1>
        <ul>
          <li>Challenge Link: https://play.picoctf.org/practice/challenge/356?category=1&difficulty=2&page=1</li>
          <li>How about trying to match a regular expression</li>
        </ul>
      </section>

      <section>
        <h1>Solution</h1>
        <p>Let's check the source code of the website, this particular code stands out:</p>
        <pre><code>&lt;script&gt;
	function send_request() {
		let val = document.getElementById("name").value;
		// ^p.....F!?
		fetch(`/flag?input=${val}`)
			.then(res =&gt; res.text())
			.then(res =&gt; {
				const res_json = JSON.parse(res);
				alert(res_json.flag)
				return false;
			})
		return false;
	}
&lt;/script&gt;
</code></pre>
        <p>The function send_request() is triggered when a certain event (like a button click) occurs. Here's the flow: This grabs the value entered by the user in an HTML input field with the id of "name".</p>
        <pre>let val = document.getElementById("name").value;</pre>
        <p>This sends a request to the server with the user's input appended to the URL as a query parameter called input. The server is expected to respond with some data (probably in JSON format).</p>
        <pre>fetch(/flag?input=${val})</pre>
        <p>Once the server responds, this line grabs the response as text.</p>
        <pre>.then(res => res.text())</pre>
        <p>After parsing the response as JSON, it looks for a property called flag in the JSON data and displays it in an alert box.</p>
        <pre>then(res => { const res_json = JSON.parse(res); alert(res_json.flag) })</pre>
        <p>But this specific part of the code is the most important:</p>
        <pre>^p.....F!?</pre>
        <p>To break it down: The caret symbol (^) is often used in regular expressions to denote the start of a string. So ^p means "the string must start with the character p".</p>
        <pre>^p:</pre>
        <p>The five dots (.....) represent any five characters in a row. In regular expressions, the dot (.) matches any character (except line breaks), and five dots would mean "any sequence of five characters".</p>
        <pre>.....:</pre>
        <p>This part indicates that after those five characters, there must be an F.</p>
        <pre>F:</pre>
        <p>The exclamation mark (!) and question mark (?) have specific meanings in regular expressions:</p>
        <pre>!?:</pre>
        <ul>
          <li>! doesn't have a special meaning in regular expressions on its own, but it might be used here as part of a string you need to match.</li>
          <li>? means "the preceding character or group is optional." In this case, it would make the ! optional.</li>
        </ul>
        <p>To sum it up, our string must:</p>
        <ul>
          <li>Start with p</li>
          <li>Be followed by exactly 5 characters (of any kind)</li>
          <li>Be followed by F</li>
          <li>Optionally have an exclamation mark (!)</li>
        </ul>
        <p>Regex matching doesn't appear directly in this code, but the pattern ^p.....F!? is likely something that the server checks against the user input and the server might be using the regex pattern to determine if the input is valid. If the input matches the expected pattern, the server responds with a flag, which is then displayed in the alert box.</p>
        <p>Which is why these will work:</p>
        <pre>pappleF
p(anythingwith5characters)F
</pre>
        <img src="../Images/MatchTheRegex/a.png" alt="example a">
        <img src="../Images/MatchTheRegex/b.png" alt="example b">

      </section>

      <section>
        <h1>Sources</h1>
        <ul>
          <li><a href="3v@l.html">Similar Regex CTF</a></li>
        </ul>
      </section>

    </main>
  </div>
</body>
</html>
